<!-- Action n Categories -->
<h3 class="header-title" *ngIf="showCatForm">
    {{"Categories" | translate}}
</h3>
<div class="container-fluid" *ngIf="showCatForm">
    <div *ngIf="showAddForm || showEditForm">
        <form [formGroup]="PageForm" (ngSubmit)="addRecord(PageForm.value)">
            <div class="row">
                <div class="col-md-4">
                    <mat-form-field appearance="fill" class="w-100">
                        <mat-label>{{"Name" | translate}}</mat-label>
                        <input type="Text" matInput formControlName="categoryName" [id]="'categoryName'"
                            maxlength="50" appNotAllowWhiteSpaceStart />
                        <mat-error *ngIf="PageForm.get('categoryName')?.hasError('required')"
                            [id]="'err_categoriesName'">
                            {{'name Required' | translate}}</mat-error>
                    </mat-form-field>
                </div>
                <div class="col-md-4">
                    <mat-form-field appearance="fill" class="w-100">
                        <mat-label>{{"Category Type" | translate}}</mat-label>
                        <mat-select [id]="'categoryTypesID'" formControlName="categoryTypesID">
                            <mat-option *ngFor="let item of categoryTypeMater" [value]="item.categoryTypesID">
                                {{item.categoryTypesName}}</mat-option>
                        </mat-select>
                        <mat-error [id]="'err_categoryTypesID'"
                            *ngIf="PageForm.get('categoryTypesID')?.hasError('required')">
                            {{'ContractType Required' | translate}}</mat-error>

                    </mat-form-field>
                </div>
                <div class="col-md-4">
                    <mat-form-field appearance="fill" class="w-100">
                        <mat-label>{{"Phase" | translate}}</mat-label>
                        <mat-select [id]="'phasesID'" formControlName="phasesID">
                            <mat-option *ngFor="let item of PhasesMater" [value]="item.phasesID">{{item.phasesName}}
                            </mat-option>
                        </mat-select>
                        <mat-error [id]="'err_phasesID'" *ngIf="PageForm.get('phasesID')?.hasError('required')">
                            {{'Phase_Required' | translate}}</mat-error>

                    </mat-form-field>
                </div>
            </div>
            <div class="row">
                <div class="col-md-4">
                    <mat-form-field appearance="fill" class="w-100">
                        <mat-label>{{"Actions" | translate}}</mat-label>
                        <mat-select [id]="'actionsID'" formControlName="actionsID">
                            <mat-option *ngFor="let item of ActionsMater" [value]="item.actionsID">{{item.actionsName}}
                            </mat-option>
                        </mat-select>
                        <mat-error [id]="'err_actionsID'" *ngIf="PageForm.get('actionsID')?.hasError('required')">
                            {{'Actions_Required' | translate}}</mat-error>

                    </mat-form-field>
                </div>
                <div class="col-md-4">
                    <mat-label>{{"Queues" | translate}}</mat-label>
                    <!-- <mat-form-field appearance="fill" class="w-100">
                      
                    </mat-form-field> -->
                    <ng-select [items]="queueTypesMater" bindLabel="queueTypesName" placeholder="{{'Select Queue Types'| translate}}"
                        appendTo="body" [multiple]="true" [searchable]="true" bindValue="queueTypesID"
                        formControlName="queuesID" (ngModelChange)="changeLeagueOwner($event)">
                    </ng-select>
                   
                </div>
            </div>

            <div class="row mt-3">
                <div class="align-items-end col-md-12 mb-4 d-flex justify-content-end">
                    <button mat-raised-button class="m-1 color-blue" [id]="'CancelAdd'" (click)="cancelAdd_Save()">{{'Cancel'|
                        translate}}</button>
                    <button mat-raised-button class="m-1 color-blue" type="submit" [id]="'Add'" *ngIf="showAddForm">
                        {{'Add' |translate}}</button>
                    <button type="button" mat-raised-button class="m-1 color-blue" [id]="'Update'" *ngIf="showEditForm"
                        (click)="updateBadgeRecord(PageForm.value)">
                        {{'Save' |translate}}
                    </button>
                </div>
            </div>
        </form>
    </div>
    <!-- Search Bar -->
    <div [hidden]="showAddForm || showEditForm">
        <div class="row">
            <div class="col-sm-12">
                <div class="align-items-center d-flex row">
                    <div class="col-6">
                        <mat-form-field appearance="fill">
                            <mat-label>{{ "Search" | translate }}</mat-label>
                            <input matInput placeholder="Type" [id]="'searchCateg'" #searchField (keyup)="applyFilter($event)" />
                        </mat-form-field>
                    </div>
                    <div class="col-6">
                        <div class="text-right">
                            <button mat-raised-button appearance="fill" [id]="'AddNew'" class="m-1 color-blue"
                                (click)="showAddFormPage()">
                                {{ "Add" | translate }}
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="mat-elevation-z8">
            <table mat-table [dataSource]="dataSource" matSort (matSortChange)="announceSortChange($event)">
                <!-- Badge Number -->
                <ng-container matColumnDef="categoryName">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                        {{ "Name" | translate }}</th>
                    <td mat-cell *matCellDef="let element" class="text-left w-350px">{{
                        element.categoryName }}
                    </td>
                </ng-container>

                <ng-container matColumnDef="categoryType">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                        {{ "Category Type" | translate }}</th>
                    <td mat-cell *matCellDef="let element" class="text-left ">{{
                        element.categoryType }}
                    </td>
                </ng-container>
                <ng-container matColumnDef="categoryPhaseType">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                        {{ "Category Phase Type" | translate }}</th>
                    <td mat-cell *matCellDef="let element" class="text-left">{{
                        element.categoryPhaseType }}
                    </td>
                </ng-container>
                <ng-container matColumnDef="categoriesQueueNames">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                        {{ "Queue Count" | translate }}</th>
                        <td mat-cell *matCellDef="let element" class="text-right">{{
                            actionQueueNamesCount(element.categoriesQueueNames) }} <mat-icon
                                *ngIf="actionQueueNamesCount(element.categoriesQueueNames) >0"
                                matTooltip="{{parseJson(element?.categoriesQueueNames)}}">info</mat-icon>
                        </td>
                </ng-container>

                <!-- Symbol Column -->
                <ng-container matColumnDef="Action">
                    <tr>
                        <th mat-header-cell *matHeaderCellDef class="text-center">
                            {{'Action' | translate}}</th>
                    </tr>
                    <tr>
                        <td mat-cell *matCellDef="let element" class="text-center">
                            <button mat-icon-button color="dark-grey" title="{{'Edit' | translate }}">
                                <mat-icon class="edit-blue" (click)="editIconClicked(element)">edit</mat-icon>
                            </button>
                            <button mat-icon-button color="dark-grey" [id]="'Disable'"
                                title="{{'Disable' | translate }}"
                                (click)="toggleType(element.categoriesID, element.active)" *ngIf="element.active">
                                <mat-icon class="color-red">block</mat-icon>
                            </button>
                            <button mat-icon-button color="dark-grey" [id]="'Enable'" title="{{'Enable' | translate }}"
                                (click)="toggleType(element.categoriesID, element.active)" *ngIf="!element.active">
                                <mat-icon class="color-green">done_outline</mat-icon>
                            </button>

                        </td>
                    <tr>
                </ng-container>

                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
            </table>
            <div class="col-sm-12 text-center" [hidden]="dataSource.filteredData?.length !== 0">
                {{'No records found' | translate}}</div>
            <mat-paginator [pageSizeOptions]="[10, 20, 50, 100]" showFirstLastButtons
                aria-label="Select page of periodic elements">
            </mat-paginator>
        </div>
    </div>
</div>